{% if collection and collection.products_count > 0 %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "ItemList",
  "name": "{{ collection.title | strip | escape }}",
  "itemListElement": [
    {% assign pos = 1 %}
    {% for p in collection.products %}{
      "@type": "ListItem",
      "position": {{ pos }},
      "url": "{{ p.url | absolute_url }}",
      "name": "{{ p.title | strip | escape }}"
    }{% assign pos = pos | plus: 1 %}{% unless forloop.last %},{% endunless %}{% endfor %}
  ]
}
</script>
{% endif %}
